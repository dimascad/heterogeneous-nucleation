<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>app</title>
    <script type="module" crossorigin src="./assets/index-EOP8MSVa.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-B7PzHRJj.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">import%20marimo%0A%0A__generated_with%20%3D%20%220.14.13%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20Slider%20for%20contact%20angle%0A%20%20%20%20theta_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D10%2C%0A%20%20%20%20%20%20%20%20stop%3D170%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20value%3D90%2C%0A%20%20%20%20%20%20%20%20label%3D%22Contact%20Angle%20%CE%B8%20(degrees)%22%2C%0A%20%20%20%20%20%20%20%20full_width%3DTrue%0A%20%20%20%20)%0A%20%20%20%20theta_slider%0A%20%20%20%20return%20(theta_slider%2C)%0A%0A%0A%40app.cell%0Adef%20_(theta_slider)%3A%0A%20%20%20%20import%20math%0A%20%20%20%20from%20PIL%20import%20Image%2C%20ImageDraw%2C%20ImageFont%0A%20%20%20%20import%20io%0A%20%20%20%20import%20base64%0A%0A%20%20%20%20WIDTH%20%3D%201100%0A%20%20%20%20HEIGHT%20%3D%20500%0A%0A%20%20%20%20%23%20High%20contrast%20color%20scheme%0A%20%20%20%20BG_COLOR%20%3D%20(15%2C%2025%2C%2045)%0A%20%20%20%20PANEL_BG%20%3D%20(20%2C%2032%2C%2055)%0A%20%20%20%20SUBSTRATE_COLOR%20%3D%20(70%2C%20100%2C%20140)%0A%20%20%20%20SUBSTRATE_HATCH%20%3D%20(55%2C%2085%2C%20120)%0A%20%20%20%20NUCLEUS_COLOR%20%3D%20(255%2C%20130%2C%20170)%0A%20%20%20%20NUCLEUS_OUTLINE%20%3D%20(255%2C%2080%2C%20130)%0A%0A%20%20%20%20WHITE%20%3D%20(255%2C%20255%2C%20255)%0A%20%20%20%20YELLOW%20%3D%20(255%2C%20220%2C%20100)%0A%20%20%20%20ORANGE%20%3D%20(255%2C%20180%2C%20100)%0A%20%20%20%20CYAN%20%3D%20(100%2C%20240%2C%20255)%0A%20%20%20%20GREEN%20%3D%20(100%2C%20255%2C%20150)%0A%20%20%20%20RED%20%3D%20(255%2C%20100%2C%20100)%0A%20%20%20%20GOLD%20%3D%20(255%2C%20215%2C%200)%0A%20%20%20%20GRAY%20%3D%20(150%2C%20150%2C%20160)%0A%20%20%20%20LIGHT_GRAY%20%3D%20(120%2C%20120%2C%20130)%0A%0A%0A%20%20%20%20def%20S(theta_deg)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Shape%20factor%20S(%CE%B8)%20%3D%20(2%20%2B%20cos%CE%B8)(1%20-%20cos%CE%B8)%C2%B2%20%2F%204%22%22%22%0A%20%20%20%20%20%20%20%20theta%20%3D%20math.radians(theta_deg)%0A%20%20%20%20%20%20%20%20c%20%3D%20math.cos(theta)%0A%20%20%20%20%20%20%20%20return%20(2%20%2B%20c)%20*%20(1%20-%20c)%20**%202%20%2F%204%0A%0A%0A%20%20%20%20def%20draw_arrow(draw%2C%20x1%2C%20y1%2C%20x2%2C%20y2%2C%20color%2C%20width%3D3%2C%20arrow_len%3D10)%3A%0A%20%20%20%20%20%20%20%20draw.line(%5B(x1%2C%20y1)%2C%20(x2%2C%20y2)%5D%2C%20fill%3Dcolor%2C%20width%3Dwidth)%0A%20%20%20%20%20%20%20%20angle%20%3D%20math.atan2(y2%20-%20y1%2C%20x2%20-%20x1)%0A%20%20%20%20%20%20%20%20al%20%3D%20arrow_len%0A%20%20%20%20%20%20%20%20pts%20%3D%20%5B(x2%2C%20y2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(x2%20-%20al*math.cos(angle-0.35)%2C%20y2%20-%20al*math.sin(angle-0.35))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(x2%20-%20al*math.cos(angle%2B0.35)%2C%20y2%20-%20al*math.sin(angle%2B0.35))%5D%0A%20%20%20%20%20%20%20%20draw.polygon(pts%2C%20fill%3Dcolor)%0A%0A%0A%20%20%20%20def%20draw_dashed(draw%2C%20x1%2C%20y1%2C%20x2%2C%20y2%2C%20color%2C%20total_len%2C%20dash%2C%20gap%2C%20width%3D1)%3A%0A%20%20%20%20%20%20%20%20dx%2C%20dy%20%3D%20x2%20-%20x1%2C%20y2%20-%20y1%0A%20%20%20%20%20%20%20%20dist%20%3D%20math.sqrt(dx*dx%20%2B%20dy*dy)%0A%20%20%20%20%20%20%20%20if%20dist%20%3C%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20dx%2C%20dy%20%3D%20dx%2Fdist%2C%20dy%2Fdist%0A%20%20%20%20%20%20%20%20pos%20%3D%200%0A%20%20%20%20%20%20%20%20while%20pos%20%3C%20dist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20%3D%20min(pos%20%2B%20dash%2C%20dist)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(x1%20%2B%20dx*pos%2C%20y1%20%2B%20dy*pos)%2C%20(x1%20%2B%20dx*end%2C%20y1%20%2B%20dy*end)%5D%2C%20fill%3Dcolor%2C%20width%3Dwidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20pos%20%2B%3D%20dash%20%2B%20gap%0A%0A%0A%20%20%20%20def%20get_fonts()%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20f_small%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans.ttf%22%2C%2011)%0A%20%20%20%20%20%20%20%20%20%20%20%20f_normal%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans.ttf%22%2C%2013)%0A%20%20%20%20%20%20%20%20%20%20%20%20f_medium%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans-Bold.ttf%22%2C%2014)%0A%20%20%20%20%20%20%20%20%20%20%20%20f_large%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans-Bold.ttf%22%2C%2016)%0A%20%20%20%20%20%20%20%20%20%20%20%20f_title%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans-Bold.ttf%22%2C%2018)%0A%20%20%20%20%20%20%20%20%20%20%20%20f_bigtitle%20%3D%20ImageFont.truetype(%22%2Fusr%2Fshare%2Ffonts%2Ftruetype%2Fdejavu%2FDejaVuSans-Bold.ttf%22%2C%2022)%0A%20%20%20%20%20%20%20%20except%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20f_small%20%3D%20f_normal%20%3D%20f_medium%20%3D%20f_large%20%3D%20f_title%20%3D%20f_bigtitle%20%3D%20ImageFont.load_default()%0A%20%20%20%20%20%20%20%20return%20f_small%2C%20f_normal%2C%20f_medium%2C%20f_large%2C%20f_title%2C%20f_bigtitle%0A%0A%0A%20%20%20%20def%20draw_nucleus(draw%2C%20cx%2C%20baseY%2C%20theta_deg%2C%20a%3D60)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Draw%20spherical%20cap%20nucleus.%20Returns%20(height%2C%20center_y%2C%20R).%22%22%22%0A%20%20%20%20%20%20%20%20theta_rad%20%3D%20math.radians(theta_deg)%0A%20%20%20%20%20%20%20%20sin_t%20%3D%20max(math.sin(theta_rad)%2C%200.05)%0A%20%20%20%20%20%20%20%20cos_t%20%3D%20math.cos(theta_rad)%0A%0A%20%20%20%20%20%20%20%20R%20%3D%20a%20%2F%20sin_t%0A%20%20%20%20%20%20%20%20R%20%3D%20min(R%2C%20400)%0A%20%20%20%20%20%20%20%20Cy%20%3D%20baseY%20%2B%20R%20*%20cos_t%0A%0A%20%20%20%20%20%20%20%20alpha_R%20%3D%20math.atan2(baseY%20-%20Cy%2C%20a)%0A%20%20%20%20%20%20%20%20alpha_L%20%3D%20math.atan2(baseY%20-%20Cy%2C%20-a)%0A%0A%20%20%20%20%20%20%20%20if%20alpha_L%20%3C%3D%20alpha_R%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20span%20%3D%20alpha_R%20-%20alpha_L%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20span%20%3D%20alpha_R%20-%20(alpha_L%20-%202*math.pi)%0A%0A%20%20%20%20%20%20%20%20arc_pts%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(61)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20i%20%2F%2060%0A%20%20%20%20%20%20%20%20%20%20%20%20angle%20%3D%20alpha_R%20-%20t%20*%20span%0A%20%20%20%20%20%20%20%20%20%20%20%20px%20%3D%20cx%20%2B%20R%20*%20math.cos(angle)%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20Cy%20%2B%20R%20*%20math.sin(angle)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20py%20%3C%3D%20baseY%20%2B%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arc_pts.append((px%2C%20py))%0A%0A%20%20%20%20%20%20%20%20if%20len(arc_pts)%20%3E%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20poly%20%3D%20%5B(cx%20-%20a%2C%20baseY)%5D%20%2B%20arc_pts%20%2B%20%5B(cx%20%2B%20a%2C%20baseY)%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.polygon(poly%2C%20fill%3DNUCLEUS_COLOR%2C%20outline%3DNUCLEUS_OUTLINE)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(arc_pts)%20%3E%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw.line(arc_pts%2C%20fill%3DNUCLEUS_OUTLINE%2C%20width%3D3)%0A%0A%20%20%20%20%20%20%20%20h%20%3D%20R%20*%20(1%20-%20cos_t)%0A%20%20%20%20%20%20%20%20return%20(h%2C%20Cy%2C%20R)%0A%0A%0A%20%20%20%20def%20draw_geometry_panel(draw%2C%20theta_deg%2C%20px%2C%20py%2C%20pw%2C%20ph%2C%20fonts)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Left%20panel%3A%20nucleus%20geometry%20with%20surface%20tensions%22%22%22%0A%20%20%20%20%20%20%20%20f_small%2C%20f_normal%2C%20f_medium%2C%20f_large%2C%20f_title%2C%20f_bigtitle%20%3D%20fonts%0A%0A%20%20%20%20%20%20%20%20draw.rectangle(%5Bpx%2C%20py%2C%20px%2Bpw%2C%20py%2Bph%5D%2C%20fill%3DPANEL_BG%2C%20outline%3DLIGHT_GRAY)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%2F%2F2%2C%20py%20%2B%2018)%2C%20%22NUCLEUS%20GEOMETRY%22%2C%20fill%3DYELLOW%2C%20anchor%3D%22mm%22%2C%20font%3Df_bigtitle)%0A%0A%20%20%20%20%20%20%20%20cx%20%3D%20px%20%2B%20pw%2F%2F2%0A%20%20%20%20%20%20%20%20baseY%20%3D%20py%20%2B%20int(ph%20*%200.58)%0A%0A%20%20%20%20%20%20%20%20substrate_top%20%3D%20baseY%0A%20%20%20%20%20%20%20%20substrate_bottom%20%3D%20baseY%20%2B%2035%0A%20%20%20%20%20%20%20%20draw.rectangle(%5Bpx%2B5%2C%20substrate_top%2C%20px%2Bpw-5%2C%20substrate_bottom%5D%2C%20fill%3DSUBSTRATE_COLOR)%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(px%2C%20px%2Bpw%2C%208)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(i%2C%20substrate_top)%2C%20(i%2B12%2C%20substrate_bottom)%5D%2C%20fill%3DSUBSTRATE_HATCH%2C%20width%3D1)%0A%0A%20%20%20%20%20%20%20%20a%20%3D%2055%0A%20%20%20%20%20%20%20%20h%2C%20Cy%2C%20R%20%3D%20draw_nucleus(draw%2C%20cx%2C%20baseY%2C%20theta_deg%2C%20a)%0A%0A%20%20%20%20%20%20%20%20theta_rad%20%3D%20math.radians(theta_deg)%0A%0A%20%20%20%20%20%20%20%20if%2025%20%3C%20theta_deg%20%3C%20150%20and%20R%20%3C%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20top_of_cap_y%20%3D%20baseY%20-%20h%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20theta_deg%20%3C%20100%20and%20R%20%3C%20150%20and%20R%20%3E%2030%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20num_segments%20%3D%2040%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arc_pts%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%20range(num_segments%20%2B%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20i%20%2F%20num_segments%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20right_angle%20%3D%20math.atan2(baseY%20-%20Cy%2C%20a)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20left_angle%20%3D%20math.atan2(baseY%20-%20Cy%2C%20-a)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20i%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20angle%20%3D%20right_angle%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arc_span%20%3D%20(2*math.pi)%20-%20(left_angle%20-%20right_angle)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20angle%20%3D%20right_angle%20-%20t%20*%20arc_span%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20px_arc%20%3D%20cx%20%2B%20R%20*%20math.cos(angle)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20py_arc%20%3D%20Cy%20%2B%20R%20*%20math.sin(angle)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arc_pts.append((px_arc%2C%20py_arc))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%20range(len(arc_pts)%20-%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20i%20%25%204%20%3C%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(py%20%2B%2035%20%3C%20arc_pts%5Bi%5D%5B1%5D%20%3C%20py%20%2B%20ph%20-%205%20and%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20py%20%2B%2035%20%3C%20arc_pts%5Bi%2B1%5D%5B1%5D%20%3C%20py%20%2B%20ph%20-%205%20and%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20px%20%2B%205%20%3C%20arc_pts%5Bi%5D%5B0%5D%20%3C%20px%20%2B%20pw%20-%205)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5Barc_pts%5Bi%5D%2C%20arc_pts%5Bi%2B1%5D%5D%2C%20fill%3D(150%2C%20170%2C%20200)%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20py%20%2B%2045%20%3C%20Cy%20%3C%20baseY%20%2B%2060%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw.ellipse(%5Bcx-5%2C%20Cy-5%2C%20cx%2B5%2C%20Cy%2B5%5D%2C%20fill%3DWHITE%2C%20outline%3D(100%2C100%2C120))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20py%20%2B%2045%20%3C%20Cy%20%3C%20baseY%20%2B%2030%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20cx%2C%20min(Cy%2C%20baseY-3)%2C%20cx%2C%20top_of_cap_y%2C%20WHITE%2C%206%2C%204%2C%202)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mid_y%20%3D%20(min(Cy%2C%20baseY%20-%2010)%20%2B%20top_of_cap_y)%20%2F%202%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20mid_y%20%3E%20py%20%2B%2055%20and%20mid_y%20%3C%20baseY%20-%2015%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw.text((cx%20%2B%2012%2C%20mid_y)%2C%20%22r%22%2C%20fill%3DWHITE%2C%20font%3Df_large)%0A%0A%20%20%20%20%20%20%20%20tpX%2C%20tpY%20%3D%20cx%20%2B%20a%2C%20baseY%0A%20%20%20%20%20%20%20%20L%20%3D%2090%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(tpX%2C%20tpY)%2C%20(tpX%20-%20L%2C%20tpY)%5D%2C%20fill%3D(0%2C%200%2C%200)%2C%20width%3D5)%0A%20%20%20%20%20%20%20%20al%20%3D%2020%0A%20%20%20%20%20%20%20%20ah_pts%20%3D%20%5B(tpX%20-%20L%2C%20tpY)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(tpX%20-%20L%20%2B%20al%2C%20tpY%20-%20al*0.35)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(tpX%20-%20L%20%2B%20al%2C%20tpY%20%2B%20al*0.35)%5D%0A%20%20%20%20%20%20%20%20draw.polygon(ah_pts%2C%20fill%3D(0%2C%200%2C%200))%0A%0A%20%20%20%20%20%20%20%20draw_arrow(draw%2C%20tpX%2C%20tpY%2C%20tpX%20%2B%20L%2C%20tpY%2C%20WHITE%2C%205%2C%20arrow_len%3D20)%0A%0A%20%20%20%20%20%20%20%20nlX%20%3D%20tpX%20-%20L%20*%20math.cos(theta_rad)%0A%20%20%20%20%20%20%20%20nlY%20%3D%20tpY%20-%20L%20*%20math.sin(theta_rad)%0A%20%20%20%20%20%20%20%20draw_arrow(draw%2C%20tpX%2C%20tpY%2C%20nlX%2C%20nlY%2C%20GOLD%2C%205%2C%20arrow_len%3D20)%0A%0A%20%20%20%20%20%20%20%20ext%20%3D%2095%0A%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20tpX%20-%20ext*math.cos(theta_rad)%2C%20tpY%20-%20ext*math.sin(theta_rad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tpX%20%2B%20ext*0.3*math.cos(theta_rad)%2C%20tpY%20%2B%20ext*0.3*math.sin(theta_rad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(180%2C%20160%2C%2080)%2C%204%2C%203%2C%201)%0A%0A%20%20%20%20%20%20%20%20ar%20%3D%2038%0A%20%20%20%20%20%20%20%20draw.arc(%5BtpX-ar%2C%20tpY-ar%2C%20tpX%2Bar%2C%20tpY%2Bar%5D%2C%20start%3D180%2C%20end%3D180%2Btheta_deg%2C%20fill%3DGREEN%2C%20width%3D5)%0A%0A%20%20%20%20%20%20%20%20draw.ellipse(%5BtpX-5%2C%20tpY-5%2C%20tpX%2B5%2C%20tpY%2B5%5D%2C%20fill%3DWHITE%2C%20outline%3DGREEN%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20draw.text((tpX%20-%20L%20-%2016%2C%20tpY%20-%2024)%2C%20%22%CE%B3%E2%82%9B%E2%82%99%22%2C%20fill%3D(0%2C%200%2C%200)%2C%20font%3Df_title)%0A%20%20%20%20%20%20%20%20draw.text((tpX%20%2B%20L%20%2B%2010%2C%20tpY%20-%2024)%2C%20%22%CE%B3%E2%82%9B%E2%82%97%22%2C%20fill%3DWHITE%2C%20font%3Df_title)%0A%20%20%20%20%20%20%20%20draw.text((nlX%20-%2036%2C%20nlY%20-%2014)%2C%20%22%CE%B3%E2%82%99%E2%82%97%22%2C%20fill%3DGOLD%2C%20font%3Df_title)%0A%0A%20%20%20%20%20%20%20%20draw.text((cx%2C%20substrate_bottom%20-%2012)%2C%20%22Substrate%22%2C%20fill%3DWHITE%2C%20anchor%3D%22mm%22%2C%20font%3Df_small)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2012%2C%20py%20%2B%2042)%2C%20%22Liquid%22%2C%20fill%3DWHITE%2C%20font%3Df_normal)%0A%20%20%20%20%20%20%20%20if%20h%20%3E%2020%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.text((cx%2C%20baseY%20-%20min(h*0.5%2C%2050))%2C%20%22Nucleus%22%2C%20fill%3DWHITE%2C%20anchor%3D%22mm%22%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20sf%20%3D%20S(theta_deg)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2012%2C%20py%20%2B%2065)%2C%20f%22%CE%B8%20%3D%20%7Btheta_deg%3A.0f%7D%C2%B0%22%2C%20fill%3DGREEN%2C%20font%3Df_large)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2012%2C%20py%20%2B%2088)%2C%20f%22S(%CE%B8)%20%3D%20%7Bsf%3A.4f%7D%22%2C%20fill%3DCYAN%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20if%20theta_deg%20%3C%2030%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Excellent%20wetting%22%2C%20GREEN%0A%20%20%20%20%20%20%20%20elif%20theta_deg%20%3C%2060%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Good%20wetting%22%2C%20GREEN%0A%20%20%20%20%20%20%20%20elif%20theta_deg%20%3C%2090%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Moderate%20wetting%22%2C%20YELLOW%0A%20%20%20%20%20%20%20%20elif%20theta_deg%20%3C%20120%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Poor%20wetting%22%2C%20ORANGE%0A%20%20%20%20%20%20%20%20elif%20theta_deg%20%3C%20150%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Very%20poor%20wetting%22%2C%20RED%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wetting%2C%20wcolor%20%3D%20%22Non-wetting%22%2C%20RED%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2012%2C%20py%20%2B%20108)%2C%20wetting%2C%20fill%3Dwcolor%2C%20font%3Df_small)%0A%0A%20%20%20%20%20%20%20%20ly%20%3D%20py%20%2B%20ph%20-%2055%0A%20%20%20%20%20%20%20%20legend_box%20%3D%20%5Bpx%20%2B%205%2C%20ly%20-%202%2C%20px%20%2B%20155%2C%20ly%20%2B%2048%5D%0A%20%20%20%20%20%20%20%20draw.rectangle(legend_box%2C%20fill%3D(45%2C%2065%2C%2095)%2C%20outline%3D(80%2C%20100%2C%20130))%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(px%20%2B%2010%2C%20ly%20%2B%208)%2C%20(px%20%2B%2028%2C%20ly%20%2B%208)%5D%2C%20fill%3D(0%2C%200%2C%200)%2C%20width%3D3)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2032%2C%20ly%20%2B%208)%2C%20%22%CE%B3%E2%82%9B%E2%82%99%20Solid-Nucleus%22%2C%20fill%3D(0%2C%200%2C%200)%2C%20anchor%3D%22lm%22%2C%20font%3Df_small)%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(px%20%2B%2010%2C%20ly%20%2B%2022)%2C%20(px%20%2B%2028%2C%20ly%20%2B%2022)%5D%2C%20fill%3DWHITE%2C%20width%3D3)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2032%2C%20ly%20%2B%2022)%2C%20%22%CE%B3%E2%82%9B%E2%82%97%20Solid-Liquid%22%2C%20fill%3DWHITE%2C%20anchor%3D%22lm%22%2C%20font%3Df_small)%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(px%20%2B%2010%2C%20ly%20%2B%2036)%2C%20(px%20%2B%2028%2C%20ly%20%2B%2036)%5D%2C%20fill%3DGOLD%2C%20width%3D3)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%2032%2C%20ly%20%2B%2036)%2C%20%22%CE%B3%E2%82%99%E2%82%97%20Nucleus-Liquid%22%2C%20fill%3DGOLD%2C%20anchor%3D%22lm%22%2C%20font%3Df_small)%0A%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%20-%208%2C%20ly%20%2B%208)%2C%20%22Young's%20equation%3A%22%2C%20fill%3DGRAY%2C%20anchor%3D%22rt%22%2C%20font%3Df_small)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%20-%208%2C%20ly%20%2B%2026)%2C%20%22%CE%B3%E2%82%9B%E2%82%97%20%3D%20%CE%B3%E2%82%9B%E2%82%99%20%2B%20%CE%B3%E2%82%99%E2%82%97%C2%B7cos%CE%B8%22%2C%20fill%3DWHITE%2C%20anchor%3D%22rt%22%2C%20font%3Df_normal)%0A%0A%0A%20%20%20%20def%20draw_shape_factor_panel(draw%2C%20theta_deg%2C%20px%2C%20py%2C%20pw%2C%20ph%2C%20fonts)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Middle%20panel%3A%20S(%CE%B8)%20vs%20%CE%B8%20curve%20with%20proper%20axes%22%22%22%0A%20%20%20%20%20%20%20%20f_small%2C%20f_normal%2C%20f_medium%2C%20f_large%2C%20f_title%2C%20f_bigtitle%20%3D%20fonts%0A%0A%20%20%20%20%20%20%20%20draw.rectangle(%5Bpx%2C%20py%2C%20px%2Bpw%2C%20py%2Bph%5D%2C%20fill%3DPANEL_BG%2C%20outline%3DLIGHT_GRAY)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%2F%2F2%2C%20py%20%2B%2018)%2C%20%22SHAPE%20FACTOR%20S(%CE%B8)%22%2C%20fill%3DYELLOW%2C%20anchor%3D%22mm%22%2C%20font%3Df_bigtitle)%0A%0A%20%20%20%20%20%20%20%20sf%20%3D%20S(theta_deg)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%2F%2F2%2C%20py%20%2B%2042)%2C%20f%22S(%7Btheta_deg%3A.0f%7D%C2%B0)%20%3D%20%7Bsf%3A.4f%7D%22%2C%20fill%3DCYAN%2C%20anchor%3D%22mm%22%2C%20font%3Df_medium)%0A%0A%20%20%20%20%20%20%20%20margin%20%3D%20%7B'l'%3A%2055%2C%20'r'%3A%2015%2C%20't'%3A%2060%2C%20'b'%3A%2055%7D%0A%20%20%20%20%20%20%20%20plot_x%20%3D%20px%20%2B%20margin%5B'l'%5D%0A%20%20%20%20%20%20%20%20plot_y%20%3D%20py%20%2B%20margin%5B't'%5D%0A%20%20%20%20%20%20%20%20plot_w%20%3D%20pw%20-%20margin%5B'l'%5D%20-%20margin%5B'r'%5D%0A%20%20%20%20%20%20%20%20plot_h%20%3D%20ph%20-%20margin%5B't'%5D%20-%20margin%5B'b'%5D%0A%0A%20%20%20%20%20%20%20%20def%20to_x(th)%3A%20return%20plot_x%20%2B%20(th%20%2F%20180)%20*%20plot_w%0A%20%20%20%20%20%20%20%20def%20to_y(s)%3A%20return%20plot_y%20%2B%20plot_h%20-%20s%20*%20plot_h%0A%0A%20%20%20%20%20%20%20%20for%20s_val%20in%20%5B0.25%2C%200.5%2C%200.75%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20to_y(s_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20y)%2C%20(plot_x%20%2B%20plot_w%2C%20y)%5D%2C%20fill%3D(40%2C%2050%2C%2070)%2C%20width%3D1)%0A%20%20%20%20%20%20%20%20for%20th_val%20in%20%5B45%2C%2090%2C%20135%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20to_x(th_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(x%2C%20plot_y)%2C%20(x%2C%20plot_y%20%2B%20plot_h)%5D%2C%20fill%3D(40%2C%2050%2C%2070)%2C%20width%3D1)%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20plot_y%20%2B%20plot_h)%2C%20(plot_x%20%2B%20plot_w%2C%20plot_y%20%2B%20plot_h)%5D%2C%20fill%3DWHITE%2C%20width%3D2)%0A%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20plot_y)%2C%20(plot_x%2C%20plot_y%20%2B%20plot_h)%5D%2C%20fill%3DWHITE%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20pts%20%3D%20%5B(to_x(th)%2C%20to_y(S(th)))%20for%20th%20in%20range(0%2C%20181%2C%202)%5D%0A%20%20%20%20%20%20%20%20draw.line(pts%2C%20fill%3DCYAN%2C%20width%3D3)%0A%0A%20%20%20%20%20%20%20%20curr_x%2C%20curr_y%20%3D%20to_x(theta_deg)%2C%20to_y(S(theta_deg))%0A%20%20%20%20%20%20%20%20draw.ellipse(%5Bcurr_x-8%2C%20curr_y-8%2C%20curr_x%2B8%2C%20curr_y%2B8%5D%2C%20fill%3DGREEN%2C%20outline%3DWHITE%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20curr_x%2C%20plot_y%20%2B%20plot_h%2C%20curr_x%2C%20curr_y%2C%20GRAY%2C%204%2C%203%2C%201)%0A%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20plot_x%2C%20curr_y%2C%20curr_x%2C%20curr_y%2C%20GRAY%2C%204%2C%203%2C%201)%0A%0A%20%20%20%20%20%20%20%20draw.text((plot_x%20%2B%20plot_w%2F%2F2%2C%20plot_y%20%2B%20plot_h%20%2B%2032)%2C%20%22Contact%20Angle%20%CE%B8%20(degrees)%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3DGREEN%2C%20anchor%3D%22mm%22%2C%20font%3Df_medium)%0A%0A%20%20%20%20%20%20%20%20for%20th_val%20in%20%5B0%2C%2045%2C%2090%2C%20135%2C%20180%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20to_x(th_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.text((x%2C%20plot_y%20%2B%20plot_h%20%2B%2014)%2C%20str(th_val)%2C%20fill%3DWHITE%2C%20anchor%3D%22mm%22%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%206%2C%20plot_y%20-%2022)%2C%20%22S(%CE%B8)%22%2C%20fill%3DCYAN%2C%20font%3Df_large)%0A%0A%20%20%20%20%20%20%20%20for%20s_val%20in%20%5B0%2C%200.25%2C%200.5%2C%200.75%2C%201.0%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20to_y(s_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.text((plot_x%20-%208%2C%20y)%2C%20f%22%7Bs_val%3A.2f%7D%22%2C%20fill%3DWHITE%2C%20anchor%3D%22rm%22%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20eq_x%20%3D%20plot_x%20%2B%20int(plot_w%20*%200.72)%0A%20%20%20%20%20%20%20%20eq_y%20%3D%20plot_y%20%2B%20int(plot_h%20*%200.78)%0A%20%20%20%20%20%20%20%20draw.text((eq_x%2C%20eq_y)%2C%20%22S(%CE%B8)%20%3D%20(2%2Bcos%CE%B8)(1%E2%88%92cos%CE%B8)%C2%B2%2F4%22%2C%20fill%3DCYAN%2C%20anchor%3D%22mm%22%2C%20font%3Df_normal)%0A%0A%0A%20%20%20%20def%20draw_barrier_panel(draw%2C%20theta_deg%2C%20px%2C%20py%2C%20pw%2C%20ph%2C%20fonts)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Right%20panel%3A%20%CE%94G%20vs%20r%20with%20barrier%20comparison%22%22%22%0A%20%20%20%20%20%20%20%20f_small%2C%20f_normal%2C%20f_medium%2C%20f_large%2C%20f_title%2C%20f_bigtitle%20%3D%20fonts%0A%0A%20%20%20%20%20%20%20%20draw.rectangle(%5Bpx%2C%20py%2C%20px%2Bpw%2C%20py%2Bph%5D%2C%20fill%3DPANEL_BG%2C%20outline%3DLIGHT_GRAY)%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%2F%2F2%2C%20py%20%2B%2018)%2C%20%22NUCLEATION%20BARRIER%20%CE%94G*%22%2C%20fill%3DYELLOW%2C%20anchor%3D%22mm%22%2C%20font%3Df_bigtitle)%0A%0A%20%20%20%20%20%20%20%20sf%20%3D%20S(theta_deg)%0A%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%20pw%2F%2F2%2C%20py%20%2B%2042)%2C%20f%22%CE%94G*%E2%82%95%E2%82%91%E2%82%9C%20%3D%20%7Bsf*100%3A.1f%7D%25%20of%20%CE%94G*%E2%82%95%E2%82%92%E2%82%98%22%2C%20fill%3DORANGE%2C%20anchor%3D%22mm%22%2C%20font%3Df_medium)%0A%0A%20%20%20%20%20%20%20%20margin%20%3D%20%7B'l'%3A%2055%2C%20'r'%3A%2015%2C%20't'%3A%2060%2C%20'b'%3A%2055%7D%0A%20%20%20%20%20%20%20%20plot_x%20%3D%20px%20%2B%20margin%5B'l'%5D%0A%20%20%20%20%20%20%20%20plot_y%20%3D%20py%20%2B%20margin%5B't'%5D%0A%20%20%20%20%20%20%20%20plot_w%20%3D%20pw%20-%20margin%5B'l'%5D%20-%20margin%5B'r'%5D%0A%20%20%20%20%20%20%20%20plot_h%20%3D%20ph%20-%20margin%5B't'%5D%20-%20margin%5B'b'%5D%0A%0A%20%20%20%20%20%20%20%20def%20dG(r%2C%20s%3D1)%3A%20%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20s%20*%20(3*r**2%20-%202*r**3)%20if%20r%20%3E%200%20else%200%0A%0A%20%20%20%20%20%20%20%20r_max%20%3D%201.5%0A%20%20%20%20%20%20%20%20dg_max%20%3D%201.15%0A%0A%20%20%20%20%20%20%20%20def%20to_x(r)%3A%20return%20plot_x%20%2B%20(r%2Fr_max)%20*%20plot_w%0A%20%20%20%20%20%20%20%20def%20to_y(g)%3A%20return%20plot_y%20%2B%20(dg_max%20-%20max(g%2C%200))%20%2F%20dg_max%20*%20plot_h%0A%0A%20%20%20%20%20%20%20%20zero_y%20%3D%20to_y(0)%0A%0A%20%20%20%20%20%20%20%20for%20g_val%20in%20%5B0.25%2C%200.5%2C%200.75%2C%201.0%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20to_y(g_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20y)%2C%20(plot_x%20%2B%20plot_w%2C%20y)%5D%2C%20fill%3D(40%2C%2050%2C%2070)%2C%20width%3D1)%0A%20%20%20%20%20%20%20%20for%20r_val%20in%20%5B0.5%2C%201.0%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20to_x(r_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(x%2C%20plot_y)%2C%20(x%2C%20plot_y%20%2B%20plot_h)%5D%2C%20fill%3D(40%2C%2050%2C%2070)%2C%20width%3D1)%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20zero_y)%2C%20(plot_x%20%2B%20plot_w%2C%20zero_y)%5D%2C%20fill%3DWHITE%2C%20width%3D2)%0A%20%20%20%20%20%20%20%20draw.line(%5B(plot_x%2C%20plot_y)%2C%20(plot_x%2C%20plot_y%20%2B%20plot_h)%5D%2C%20fill%3DWHITE%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20prev%20%3D%20None%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(0%2C%20101%2C%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20i%2F100%20*%20r_max%0A%20%20%20%20%20%20%20%20%20%20%20%20g%20%3D%20dG(r%2C%201.0)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%200%20%3C%3D%20g%20%3C%3D%20dg_max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pt%20%3D%20(to_x(r)%2C%20to_y(g))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20prev%20and%20i%20%25%203%20%3C%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5Bprev%2C%20pt%5D%2C%20fill%3DGRAY%2C%20width%3D2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20prev%20%3D%20pt%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20prev%20%3D%20None%0A%0A%20%20%20%20%20%20%20%20het_pts%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(101)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20i%2F100%20*%20r_max%0A%20%20%20%20%20%20%20%20%20%20%20%20g%20%3D%20dG(r%2C%20sf)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%200%20%3C%3D%20g%20%3C%3D%20dg_max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20het_pts.append((to_x(r)%2C%20to_y(g)))%0A%20%20%20%20%20%20%20%20if%20len(het_pts)%20%3E%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(het_pts%2C%20fill%3DCYAN%2C%20width%3D3)%0A%0A%20%20%20%20%20%20%20%20r_star_x%20%3D%20to_x(1.0)%0A%20%20%20%20%20%20%20%20hom_peak_y%20%3D%20to_y(1.0)%0A%20%20%20%20%20%20%20%20het_peak_y%20%3D%20to_y(sf)%0A%0A%20%20%20%20%20%20%20%20draw.line(%5B(r_star_x%2C%20plot_y)%2C%20(r_star_x%2C%20zero_y)%5D%2C%20fill%3D(60%2C%2080%2C%20100)%2C%20width%3D1)%0A%0A%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20r_star_x%2C%20zero_y%2C%20r_star_x%2C%20hom_peak_y%2C%20ORANGE%2C%204%2C%203%2C%201)%0A%20%20%20%20%20%20%20%20draw.ellipse(%5Br_star_x-5%2C%20hom_peak_y-5%2C%20r_star_x%2B5%2C%20hom_peak_y%2B5%5D%2C%20fill%3DGRAY%2C%20outline%3DWHITE)%0A%0A%20%20%20%20%20%20%20%20draw_dashed(draw%2C%20r_star_x%2B2%2C%20zero_y%2C%20r_star_x%2B2%2C%20het_peak_y%2C%20ORANGE%2C%204%2C%203%2C%201)%0A%20%20%20%20%20%20%20%20draw.ellipse(%5Br_star_x-7%2C%20het_peak_y-7%2C%20r_star_x%2B7%2C%20het_peak_y%2B7%5D%2C%20fill%3DORANGE%2C%20outline%3DWHITE%2C%20width%3D2)%0A%0A%20%20%20%20%20%20%20%20if%20sf%20%3C%200.85%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20ax%20%3D%20r_star_x%20%2B%2022%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.line(%5B(ax%2C%20zero_y-2)%2C%20(ax%2C%20het_peak_y%2B2)%5D%2C%20fill%3DORANGE%2C%20width%3D2)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.polygon(%5B(ax%2C%20het_peak_y)%2C%20(ax-4%2C%20het_peak_y%2B8)%2C%20(ax%2B4%2C%20het_peak_y%2B8)%5D%2C%20fill%3DORANGE)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.polygon(%5B(ax%2C%20zero_y)%2C%20(ax-4%2C%20zero_y-8)%2C%20(ax%2B4%2C%20zero_y-8)%5D%2C%20fill%3DORANGE)%0A%0A%20%20%20%20%20%20%20%20lx%2C%20ly%20%3D%20plot_x%20%2B%20plot_w%20-%205%2C%20plot_y%20%2B%2012%0A%20%20%20%20%20%20%20%20draw.line(%5B(lx-115%2C%20ly)%2C%20(lx-88%2C%20ly)%5D%2C%20fill%3DGRAY%2C%20width%3D2)%0A%20%20%20%20%20%20%20%20draw.text((lx-84%2C%20ly)%2C%20%22Homogeneous%22%2C%20fill%3DWHITE%2C%20anchor%3D%22lm%22%2C%20font%3Df_small)%0A%20%20%20%20%20%20%20%20draw.line(%5B(lx-115%2C%20ly%2B16)%2C%20(lx-88%2C%20ly%2B16)%5D%2C%20fill%3DCYAN%2C%20width%3D3)%0A%20%20%20%20%20%20%20%20draw.text((lx-84%2C%20ly%2B16)%2C%20%22Heterogeneous%22%2C%20fill%3DWHITE%2C%20anchor%3D%22lm%22%2C%20font%3Df_small)%0A%0A%20%20%20%20%20%20%20%20draw.text((plot_x%20%2B%20plot_w%2F%2F2%2C%20plot_y%20%2B%20plot_h%20%2B%2032)%2C%20%22Normalized%20Radius%20r%2Fr*%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3DWHITE%2C%20anchor%3D%22mm%22%2C%20font%3Df_medium)%0A%0A%20%20%20%20%20%20%20%20for%20r_val%20in%20%5B0%2C%200.5%2C%201.0%2C%201.5%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20to_x(r_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20label%20%3D%20%22r*%22%20if%20r_val%20%3D%3D%201.0%20else%20f%22%7Br_val%3A.1f%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.text((x%2C%20zero_y%20%2B%2014)%2C%20label%2C%20fill%3DWHITE%2C%20anchor%3D%22mm%22%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20draw.text((px%20%2B%205%2C%20plot_y%20-%2012)%2C%20%22%CE%94G%2F%CE%94G*%E2%82%95%E2%82%92%E2%82%98%22%2C%20fill%3DORANGE%2C%20font%3Df_medium)%0A%0A%20%20%20%20%20%20%20%20for%20g_val%20in%20%5B0%2C%200.5%2C%201.0%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20to_y(g_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20draw.text((plot_x%20-%208%2C%20y)%2C%20f%22%7Bg_val%3A.1f%7D%22%2C%20fill%3DWHITE%2C%20anchor%3D%22rm%22%2C%20font%3Df_normal)%0A%0A%20%20%20%20%20%20%20%20eq_x%20%3D%20plot_x%20%2B%20int(plot_w%20*%200.30)%0A%20%20%20%20%20%20%20%20eq_y%20%3D%20plot_y%20%2B%20int(plot_h%20*%200.15)%0A%20%20%20%20%20%20%20%20draw.text((eq_x%2C%20eq_y)%2C%20%22%CE%94G*%E2%82%95%E2%82%91%E2%82%9C%20%3D%20S(%CE%B8)%C2%B7%CE%94G*%E2%82%95%E2%82%92%E2%82%98%22%2C%20fill%3DORANGE%2C%20anchor%3D%22mm%22%2C%20font%3Df_medium)%0A%0A%0A%20%20%20%20def%20draw_frame(theta_deg)%3A%0A%20%20%20%20%20%20%20%20img%20%3D%20Image.new('RGB'%2C%20(WIDTH%2C%20HEIGHT)%2C%20BG_COLOR)%0A%20%20%20%20%20%20%20%20draw%20%3D%20ImageDraw.Draw(img)%0A%20%20%20%20%20%20%20%20fonts%20%3D%20get_fonts()%0A%0A%20%20%20%20%20%20%20%20gap%20%3D%208%0A%20%20%20%20%20%20%20%20panel_w%20%3D%20(WIDTH%20-%204*gap)%20%2F%2F%203%0A%20%20%20%20%20%20%20%20panel_h%20%3D%20HEIGHT%20-%202*gap%0A%0A%20%20%20%20%20%20%20%20draw_geometry_panel(draw%2C%20theta_deg%2C%20gap%2C%20gap%2C%20panel_w%2C%20panel_h%2C%20fonts)%0A%20%20%20%20%20%20%20%20draw_shape_factor_panel(draw%2C%20theta_deg%2C%20gap*2%20%2B%20panel_w%2C%20gap%2C%20panel_w%2C%20panel_h%2C%20fonts)%0A%20%20%20%20%20%20%20%20draw_barrier_panel(draw%2C%20theta_deg%2C%20gap*3%20%2B%20panel_w*2%2C%20gap%2C%20panel_w%2C%20panel_h%2C%20fonts)%0A%0A%20%20%20%20%20%20%20%20return%20img%0A%0A%20%20%20%20%23%20Generate%20the%20image%20for%20current%20theta%0A%20%20%20%20theta%20%3D%20theta_slider.value%0A%20%20%20%20img%20%3D%20draw_frame(theta)%0A%0A%20%20%20%20%23%20Convert%20to%20displayable%20format%0A%20%20%20%20buffer%20%3D%20io.BytesIO()%0A%20%20%20%20img.save(buffer%2C%20format%3D'PNG')%0A%20%20%20%20buffer.seek(0)%0A%20%20%20%20img_base64%20%3D%20base64.b64encode(buffer.getvalue()).decode()%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20mo.Html(f'%3Cimg%20src%3D%22data%3Aimage%2Fpng%3Bbase64%2C%7Bimg_base64%7D%22%20style%3D%22max-width%3A%20100%25%3B%22%3E')%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%20Heterogeneous%20Nucleation%20Visualization%0A%0A%20%20%20%20This%20interactive%20visualization%20demonstrates%20how%20**contact%20angle%20%CE%B8**%20affects%20heterogeneous%20nucleation%3A%0A%0A%20%20%20%20-%20**Left%20panel**%3A%20Shows%20the%20nucleus%20geometry%20as%20a%20spherical%20cap%20on%20a%20substrate%2C%20with%20surface%20tension%20vectors%20(%CE%B3%E2%82%9B%E2%82%99%2C%20%CE%B3%E2%82%9B%E2%82%97%2C%20%CE%B3%E2%82%99%E2%82%97)%20and%20the%20contact%20angle%20%CE%B8%0A%20%20%20%20-%20**Middle%20panel**%3A%20The%20shape%20factor%20S(%CE%B8)%20curve%20-%20this%20determines%20how%20much%20the%20nucleation%20barrier%20is%20reduced%0A%20%20%20%20-%20**Right%20panel**%3A%20Comparison%20of%20homogeneous%20vs%20heterogeneous%20nucleation%20energy%20barriers%0A%0A%20%20%20%20%23%23%23%20Key%20Physics%0A%0A%20%20%20%20The%20shape%20factor%20is%20given%20by%3A%0A%0A%20%20%20%20**S(%CE%B8)%20%3D%20(2%20%2B%20cos%20%CE%B8)(1%20-%20cos%20%CE%B8)%C2%B2%20%2F%204**%0A%0A%20%20%20%20This%20determines%20the%20heterogeneous%20nucleation%20barrier%3A%0A%0A%20%20%20%20**%CE%94G*_het%20%3D%20S(%CE%B8)%20%C2%B7%20%CE%94G*_hom**%0A%0A%20%20%20%20-%20At%20%CE%B8%20%E2%86%92%200%C2%B0%20(perfect%20wetting)%3A%20S%20%E2%86%92%200%2C%20barrier%20nearly%20eliminated%0A%20%20%20%20-%20At%20%CE%B8%20%3D%2090%C2%B0%3A%20S%20%3D%200.5%2C%20barrier%20halved%20%20%0A%20%20%20%20-%20At%20%CE%B8%20%E2%86%92%20180%C2%B0%20(no%20wetting)%3A%20S%20%E2%86%92%201%2C%20no%20reduction%20(same%20as%20homogeneous)%0A%0A%20%20%20%20Use%20the%20slider%20above%20to%20explore%20how%20different%20contact%20angles%20affect%20nucleation!%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.14.13",
            "serverToken": "unused",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
